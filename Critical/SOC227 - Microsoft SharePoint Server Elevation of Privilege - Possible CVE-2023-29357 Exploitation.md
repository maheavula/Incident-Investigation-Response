# ‚≠ê SOC227 - Microsoft SharePoint Server Elevation of Privilege - Possible CVE-2023-29357 Exploitation  

## Overview  

![Overview](https://github.com/user-attachments/assets/ae2b3d21-b429-4855-9cee-6f361a9ba465)  

This report investigates the **SOC227 - Microsoft SharePoint Server Elevation of Privilege** alert, which is related to a potential **CVE-2023-29357** exploitation. As the vulnerability is **critical** and potentially exploitable, thorough investigation is required to determine whether this is a **true positive**.  

---

## Investigation Steps  

### 1. **Taking Ownership and Creating a Case**  
Begin by **taking ownership** of the alert via the main channel.  
Next, **create a case** by clicking the appropriate button, which redirects to **Case Management** to initiate the investigation using the playbook.  

![Incident Details](https://github.com/user-attachments/assets/f73bb4d3-6bff-4ece-b259-3eda57c6a899)  

Click **"Start Playbook"** to begin the investigation.  

---

### 2. **Understanding the Alert Trigger**  
The alert was triggered when a **query targeting siteusers** was detected, attempting to retrieve usernames **without proper authentication**. This is classified as a **privilege elevation attack**, with a **critical** severity rating.  

Click **Next** to proceed.  

---

### 3. **Collecting Key Information**  
Gather traffic and source details to support the investigation.  

![Collect Data](https://github.com/user-attachments/assets/2020ea95-7ccf-4736-a1b9-40348a64bb1e)  

- **IP Reputation Check**: The source IP appears over a **thousand times** in **AbuseIPDB** and has a **poor reputation** on **Cisco Talos**.  
![AbuseIPDB](https://github.com/user-attachments/assets/c00e9cd5-d247-4b65-9a79-fd441f7ae378)  

---

### 4. **Reviewing Traffic Content**  
Review **logs and endpoint security network history** for evidence of suspicious activity (e.g., SQL Injection, XSS, Command Injection, IDOR, RFI/LFI).  

No relevant logs were found for the flagged IP except for a **single HTTP request** that triggered the alert. Click **Next** to proceed.  

![Traffic Review](https://github.com/user-attachments/assets/a4d5fae8-621a-4fd5-bc87-e46c887f49fb)  

---

### 5. **Determining Maliciousness**  
Analyze the traffic in more detail.  
- **Result**: Three logs indicate that the suspicious IP address requested access to **siteusers**, confirming **malicious traffic**.  
Select **"Malicious"** to proceed.  

![Malicious Traffic](https://github.com/user-attachments/assets/b1b3cd2f-fef8-484f-b952-cef66f2480c0)  

---

### 6. **Identifying the Attack Type**  
The attack type is **web attack**, though it is not listed in the options. Select **"Other"** to continue the investigation.  

---

### 7. **Checking for Planned Activity**  
Investigate whether this activity could be part of an authorized **simulation** or planned test.  
After reviewing **email security logs**, no relevant data was found. Therefore, select **"Not Planned"**.  

![Planned Activity Check](https://github.com/user-attachments/assets/43118ac4-dc41-4335-88c1-628ad2eb64d4)  

---

### 8. **Determining Traffic Direction**  
Based on the **alert details**, the traffic originated from an **external IP address** and was directed to the **company network**.  
Select **"Internet to Company Network"** as the traffic flow format.  

![Traffic Direction](https://github.com/user-attachments/assets/066b6471-dddb-4897-80f3-6abbff962219)  

---

### 9. **Confirming Command Execution**  
The **GET request** contained the following URL:  

`GET /_api/web/currentuser`


This confirms that the **attacker successfully retrieved the current user** information, indicating a **successful privilege escalation attack**.  
Click **"Successful"** to proceed.  

![Attack Successful](https://github.com/user-attachments/assets/ad100715-ac5b-474b-a430-bcb3da3545eb)  

---

### 10. **Containing the Device**  
Since the attack was **successful**, the affected device must be **contained** to prevent further exploitation.  
Initiate **containment** using the **endpoint security page**.  

![Containment](https://github.com/user-attachments/assets/2d576a69-9fde-4f44-ba87-295e1f5674d3)  

---

### 11. **Submitting Artifacts**  
Document all relevant artifacts (e.g., IP addresses, URLs) in the designated fields.  

![Artifacts](https://github.com/user-attachments/assets/c0659ca0-7907-47b7-81c4-b58e488c4136)  

---

### 12. **Escalating the Case to Tier 2**  
Given the **successful attack** and potential severity of the vulnerability, escalate the case to **Tier 2** for further analysis.  
Click **"Yes"** to confirm the escalation.  

![Escalation](https://github.com/user-attachments/assets/1a2c31be-7039-4127-8b14-d6189af09e93)  

---

### 13. **Writing the Analysis Note**  
Draft the final analysis note:  
- **Confirmed true positive**: The **privilege escalation attack** was successfully performed.  
- **Unauthorized access** to the **current user information** was achieved.  
- The affected system was **contained**, and the case was **escalated to Tier 2**.  

![Playbook End](https://github.com/user-attachments/assets/2206eda4-24a4-471c-904a-015b86ca57e4)  

---

### 14. **Closing the Playbook and Alert**  
Click **"Confirm"** to finish the playbook.  

![Confirm Playbook](https://github.com/user-attachments/assets/9d89ffdb-4e98-49ae-be02-b3faca62c3bd)  

Finally, close the alert by selecting **"True Positive"**. Enter the final note and click **"Close"**.  

---

## Conclusion  

This investigation confirms that the **SOC227 - Microsoft SharePoint Server Elevation of Privilege** alert is a **true positive**. The attacker successfully exploited a **vulnerability** to retrieve the **current user information** without proper authentication. The affected device was **contained**, and the case was **escalated to Tier 2** for further investigation.  

Remain vigilant and continue to monitor for similar threats.  
