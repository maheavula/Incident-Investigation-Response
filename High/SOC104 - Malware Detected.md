# SOC104 - Malware Detected  

## Overview  

![Overview](https://github.com/user-attachments/assets/0ad4088f-f8bd-4748-aa8e-b6c23e319cfd)  

This report covers the **SOC104 - Malware Detected** alert. The alert classification is **Malware**, and this investigation follows a step-by-step approach using the standard incident response **playbook**. 

---

## Investigation Steps  

### 1. **Creating a Case**  
To initiate the investigation, create a case by clicking the **"Create Case"** button available under the **Action** button.  
![Create a case](https://github.com/user-attachments/assets/220c9c8d-649a-4df5-a158-0bc9d6e08313)  

After creating the case, you will be redirected to **Case Management** to start the playbook-guided investigation.  

---

### 2. **Starting the Playbook**  
Click **"Start Playbook"** to begin the investigation. The playbook asks us to **define the threat indicator** from several options. Based on the information provided, select **"Other"** from the dropdown list, as the other predefined options are not applicable.  
![Threat indicator](https://github.com/user-attachments/assets/199f8b50-784f-4587-b6dc-d52c46e54997)  

---

### 3. **Checking if Malware is Quarantined**  
Next, determine if the malware is **quarantined** by reviewing **log management** and **endpoint security** pages.  
- **Observation**: The malware was **not contained**. The file was allowed to pass, and no active processes were found on the endpoint.  
![Contained or not](https://github.com/user-attachments/assets/0bd15df7-c9f4-4171-a121-fed5274db2f5)  

Select **"Not Quarantined"** to proceed with the investigation.  
![Not quarantined](https://github.com/user-attachments/assets/08db4bf3-f5d9-475c-8e93-d987755089f2)  

---

### 4. **Analyzing the Malware File**  
Using the file's **hash**, search in **sandbox environments** and threat intelligence platforms to identify potential **Command and Control (C2)** addresses.  
![VirusTotal](https://github.com/user-attachments/assets/b30ed90d-8fdf-41dd-8c4a-df1887f6823b)  

- **Result from VirusTotal**:  
   - 65 detection engines flagged the file as **malicious**.  
   - It was identified as **ransomware**, **trojan**, and **adware**.  
   - The file exhibits behaviors associated with **MITRE ATT&CK** tactics and techniques.  
![MITRE ATT&CK](https://github.com/user-attachments/assets/3c565786-fef3-4933-b7b9-03d820b4f0f3)  

---

### 5. **Investigating C2 Communications**  
Check the **log management page** for evidence of outbound requests to the identified C2 IP address.  
- **Result**:  
   - Source IP made a **connection** on port **443** to the C2 IP address: **92.63.8.47**.  
Select **"Accessed"** to confirm this activity.  
![Accessed](https://github.com/user-attachments/assets/16405e7f-ae6e-49b4-ac60-0c250e037916)  

---

### 6. **Containing the System**  
Since the malware is confirmed as malicious, **contain the endpoint** from the **endpoint security page** to prevent further spread.  
![Contained](https://github.com/user-attachments/assets/38307685-b688-4a25-b0cf-f12175c348f1)  

---

### 7. **Adding Indicators of Compromise (IOCs)**  
Click **Next** in the playbook and add the **IOCs** (hashes, C2 addresses) related to the malware.  
![Artifacts](https://github.com/user-attachments/assets/abd2862f-5e7c-454d-857d-73f40206186e)  

---

### 8. **Entering Analysis Notes**  
Document the findings in the **Analysis Note**:  
- The file was confirmed to be **malicious** based on its characteristics and behavior.  
- Although the malware was allowed initially and the system wasnâ€™t contained, it made a **C2 connection** request.  

![Analysis note](https://github.com/user-attachments/assets/3c0ab005-7f4f-43b5-b8b7-55f1109f31c7)  

---

### 9. **Completing the Playbook and Closing the Case**  
After completing all steps, click **"Confirm"** to finalize the playbook.  
![Finish playbook](https://github.com/user-attachments/assets/bf6cc880-eb3b-46b0-86d5-d1dabd2f59b8)  

You will be redirected to the **Investigation Page**. From here, click **"Close Alert"** to mark the case as resolved.  
![Close alert](https://github.com/user-attachments/assets/f1f784f5-00de-41d8-b125-ca5622a7cde6)  

---

## Conclusion  

This investigation confirms that the alert was a **true positive**. The file exhibited malicious behavior, including C2 communication. The necessary **containment** and **remediation** steps were applied to mitigate the threat.  

Thank you for following through the investigation process. Stay vigilant, and happy incident investigating!
