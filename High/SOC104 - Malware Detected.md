# SOC104 - Malware Detected

## overview

![overview](https://github.com/user-attachments/assets/0ad4088f-f8bd-4748-aa8e-b6c23e319cfd)

Hey folks, welcome back....
Today we are going to investigate SOC104 - Malware Detected alert, As we see from overiew that type of file of alert is Malware. 

This would be very interesting because it is our favorite type hahah...
So Lets start...

First to start the investigate using playbook we need to create a case by clicking on create case button below action button.

![Create a case](https://github.com/user-attachments/assets/220c9c8d-649a-4df5-a158-0bc9d6e08313)

Once completion of creating case, you will be redirected to case management to investigating using playbook.

![incident details](https://github.com/user-attachments/assets/442a7e3b-284f-4205-afd8-89dd9bfcb1b0)

Once click on start playbook, then we should answer the question which are in playbook, it is asking that define threat indicator, we have 4 options, with the given details, those three options are not suitable so click on Other option from dropdown.

![threat indicator](https://github.com/user-attachments/assets/199f8b50-784f-4587-b6dc-d52c46e54997)

Now we need to check whether the malware is quarantined, to verify that check in log management and endpoint security pages.
Even though device is not contained, the file was allowed and there were no process or anything.

![contained or not](https://github.com/user-attachments/assets/0bd15df7-c9f4-4171-a121-fed5274db2f5)

Click on not quarantined, to move further investigation.

![Not quarantined](https://github.com/user-attachments/assets/08db4bf3-f5d9-475c-8e93-d987755089f2)

Now, we need to analyze the malware file and find the C2 address by searching the hash of file in sanboxes and threat intels.

![virustotal](https://github.com/user-attachments/assets/b30ed90d-8fdf-41dd-8c4a-df1887f6823b)

From Virustoal, we got verdict from 65 machine as it was malicous, and it was under ransomware, trojan and adware categories. So it is malicious.
It had also followed the MITRE ATTACK and tactics and techniques for the malcious purpose,

![mitre attack](https://github.com/user-attachments/assets/3c565786-fef3-4933-b7b9-03d820b4f0f3)

Now, Check if someone requested to C2 from log management page, search IP address of source, we see it was 443 dst port address and requested to this IP address 92.63.8.47. So click on Accessed.

![accessed](https://github.com/user-attachments/assets/16405e7f-ae6e-49b4-ac60-0c250e037916)

So, the file is malicious and for not spreading the malware to other systems, just contain the system from endpoint security page.

![contained](https://github.com/user-attachments/assets/38307685-b688-4a25-b0cf-f12175c348f1)

Then click on Next on playbook, and add the IOCs of malware.

![artifacts](https://github.com/user-attachments/assets/abd2862f-5e7c-454d-857d-73f40206186e)

Confirmed that it is malicious file, because of its characteristics and behaviour. Security device allowed the file and system was not contained, source requested http and C2. Enter into analysis note.

![Analysis note](https://github.com/user-attachments/assets/3c0ab005-7f4f-43b5-b8b7-55f1109f31c7)

As we investigated the alert with playbook, finally we should finish the playbook by clicking on confirm.

![finish playbook](https://github.com/user-attachments/assets/bf6cc880-eb3b-46b0-86d5-d1dabd2f59b8)

After clicking on confirm, it will redirected to investigation page, and click on close alert button to close the investigation.


![close alert](https://github.com/user-attachments/assets/f1f784f5-00de-41d8-b125-ca5622a7cde6)

So finally, it is true positive alert and closing by entering note.

Thank you for following through the investigation process. Stay vigilant, and happy incident investigating!






